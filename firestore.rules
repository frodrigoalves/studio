
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // Helper function to check for admin access
    function isAdmin() {
      return request.auth != null;
    }
    
    // Default deny all access unless specified otherwise
    match /{document=**} {
      allow read, write: if false;
    }

    // Rules for Trip Records (KM Registration)
    match /tripRecords/{recordId} {
      // Public: allow creating new records, getting a single record, and listing/querying
      allow create, get, list: if true;
      // Admin: allow reading, updating, and deleting
      allow read, update, delete: if isAdmin();
    }

    // Rules for Checklist Records (Vistoria)
    match /checklistRecords/{recordId} {
        // Public: allow creating new checklist records
        allow create: if true;
        // Admin: allow full access
        allow read, update, delete: if isAdmin();
    }
    
    // Rules for Fueling Records
    match /fuelingRecords/{recordId} {
        // Public: allow creating new fueling records
        allow create: if true;
        // Admin: allow full access
        allow read, update, delete: if isAdmin();
    }
    
    // Rules for Diesel Prices
    match /dieselPrices/{priceId} {
        // Admin only
        allow read, write: if isAdmin();
    }
    
    // Rules for Vehicle Parameters
    match /vehicleParameters/{carId} {
        // Public: allow reading a single vehicle's parameters
        allow get: if true;
        // Admin: allow full access
        allow read, write: if isAdmin();
    }
    
    // Rules for Maintenance Records
    match /maintenanceRecords/{recordId} {
        // Admin only
        allow read, write: if isAdmin();
    }
  }
}
