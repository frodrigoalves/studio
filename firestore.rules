
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    function isManager() {
      // Check for custom claims if you implement them. For now, just check auth.
      return request.auth != null;
    }

    // Public forms can be written to by anyone.
    // Reading/editing/deleting is restricted to managers.
    match /{collectionName}/{docId} 
      where collectionName in ['tripRecords', 'fuelingRecords', 'checklistRecords'] {
      allow create: if true;
      allow read, get, list: if isManager();
      allow update, delete: if isManager();
    }
    
    // Settings and other internal collections can only be managed by managers.
    match /{collectionName}/{docId}
      where collectionName in ['dieselPrices', 'vehicleParameters', 'maintenanceRecords'] {
        allow read, get, list, create, update, delete: if isManager();
    }
  }
}
