rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Regra geral: Permite que qualquer pessoa leia os dados, mas apenas
    // a aplicação (com as devidas lógicas de senha) pode escrever, atualizar ou apagar.
    // A criação é permitida para os formulários públicos.
    match /{document=**} {
      allow read, create: if true;
      allow write: if request.auth != null; // Protege contra escrita não autenticada geral
    }

    // Sobrescreve a regra geral para coleções específicas, se necessário.
    // Por exemplo, mantemos a lógica de que qualquer um pode criar registros de viagem.
     match /tripRecords/{tripRecordId} {
      allow read, create: if true;
      allow update, delete: if request.auth != null; // Protegido por segurança (futuro)
    }
     match /checklistRecords/{checklistRecordId} {
      allow read, create: if true;
      allow update, delete: if request.auth != null;
    }
     match /fuelingRecords/{fuelingRecordId} {
      allow read, create: if true;
      allow update, delete: if request.auth != null;
    }
    match /dieselPrices/{priceId} {
      allow read, create: if true;
      allow update, delete: if request.auth != null;
    }
     match /vehicleParameters/{vehicleId} {
      allow read, create, update: if true; // Permite o upload de planilhas
      allow delete: if request.auth != null;
    }
     match /maintenanceRecords/{maintId} {
      allow read, create: if true;
      allow update, delete: if request.auth != null;
    }
  }
}
